


<!DOCTYPE html>
<html>

<head>
<style>
body {
    background-color: ivory;
}
canvas {
    border:1px solid red;
}
</style>
</head>

<body>
<p>Dragging ship drawings</p>
<p>Hit testing uses context.isPointInPath</p>


<button onclick="myFunction()">Click me</button>

<p id="demo"> Total Area </p>


<canvas id="canvas" width=300 height=300></canvas






</body>

</html>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");
ctx.strokeStyle = "lightgray";


var canvasOffset = $("#canvas").offset();
var offsetX = canvasOffset.left;
var offsetY = canvasOffset.top;

var mouseIsDown = false;
var lastX = 0;
var lastY = 0;

var ships = [];


// output for iterations

//document.getElementById("demo").innerHTML = txt;





function myFunction() {

  //document.getElementById("demo").innerHTML = "Hello World";
  
	  ships.forEach(function (arrayItem) {
		var x = arrayItem.x;
		console.log("ee", arrayItem.x,arrayItem.y,arrayItem.width);
	});
	
  makeShip(50, 50, 30, 30, "yellow");
  
}






// make some ship
makeShip(20, 30, 150, 150, "green");
makeShip(20, 100, 30, 25, "skyblue");
makeShip(20, 170, 50, 25, "salmon");
makeShip(20, 240, 30, 25, "blue");



function makeShip(x, y, width, height, fill) {
    var ship = {
        x: x,
        y: y,
        width: width,
        height: height,
        right: x + width,
        bottom: y + height,
        fill: fill
    }
    ships.push(ship);
    return (ship);
}

drawAllShips();

function drawAllShips() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (var i = 0; i < ships.length; i++) {
        var ship = ships[i]
        drawShip(ship);
        ctx.fillStyle = ship.fill;
        ctx.fill();
        ctx.stroke();
    }
}

function drawShip(ship) {
    ctx.beginPath();
    ctx.moveTo(ship.x, ship.y);
    ctx.lineTo(ship.right, ship.y);
    ctx.lineTo(ship.right + 10, ship.y + ship.height / 2);
    ctx.lineTo(ship.right, ship.bottom);
    ctx.lineTo(ship.x, ship.bottom);
    ctx.closePath();
}

function handleMouseDown(e) {
    mouseX = parseInt(e.clientX - offsetX);
    mouseY = parseInt(e.clientY - offsetY);

    // mousedown stuff here
    lastX = mouseX;
    lastY = mouseY;
    mouseIsDown = true;

}

function handleMouseUp(e) {
    mouseX = parseInt(e.clientX - offsetX);
    mouseY = parseInt(e.clientY - offsetY);

    // mouseup stuff here
    mouseIsDown = false;
}

function handleMouseMove(e) {
    if (!mouseIsDown) {
        return;
    }

    mouseX = parseInt(e.clientX - offsetX);
    mouseY = parseInt(e.clientY - offsetY);

    // mousemove stuff here
    for (var i = 0; i < ships.length; i++) {
        var ship = ships[i];
        drawShip(ship);
        if (ctx.isPointInPath(lastX, lastY)) {
            ship.x += (mouseX - lastX);
            ship.y += (mouseY - lastY);
            ship.right = ship.x + ship.width;
            ship.bottom = ship.y + ship.height;
        }
    }
    lastX = mouseX;
    lastY = mouseY;
    drawAllShips();
}


function intersectingRect(r1,r2){
  var x=Math.max(r1.x,r2.x);
  var y=Math.max(r1.y,r2.y);
  var xx=Math.min(r1.x+r1.w,r2.x+r2.w);
  var yy=Math.min(r1.y+r1.h,r2.y+r2.h);
  return({x:x,y:y,w:xx-x,h:yy-y});
}



$("#canvas").mousedown(function (e) {
    handleMouseDown(e);
});
$("#canvas").mousemove(function (e) {
    handleMouseMove(e);
});
$("#canvas").mouseup(function (e) {
    handleMouseUp(e);
});



</script>


